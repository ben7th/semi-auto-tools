# Tauri 开发问题总结

## 项目背景

尝试将原有的 Python + Gradio + Playwright 工具迁移到 Tauri + React + TypeScript 技术栈，实现桌面应用版本。

## 遇到的问题

### 1. Tauri CLI 安装问题

**问题描述**：
```bash
bun run tauri dev
$ tauri dev
bun: command not found: tauri
```

**原因分析**：
- Tauri CLI 需要全局安装或通过 npx 调用
- bun 在 Windows 环境下路径解析存在问题

**解决方案**：
- 安装 Tauri CLI：`npm install -g @tauri-apps/cli`
- 或使用 npx：`npx tauri dev`

### 2. 配置文件格式问题

**问题描述**：
```bash
Error `tauri.conf.json` error: "identifier" is a required property
Error `tauri.conf.json` error on `build`: Additional properties are not allowed
```

**原因分析**：
- Tauri 2.0 相比 1.x 版本配置格式有重大变化
- 配置文件结构完全重构
- 官方文档和示例不够清晰

**尝试的配置格式**：
- 初始配置：包含 `devPath`、`distDir` 等属性
- 修改后：移除不兼容属性，使用 `frontendDist`、`devUrl`
- 最终配置：最简化，只保留 `$schema`

### 3. 项目结构问题

**问题描述**：
```bash
Input watch path is neither a file nor a directory.
```

**原因分析**：
- Tauri 2.0 要求配置文件放在 `src-tauri/` 目录中
- 前端代码和 Rust 代码需要特定的目录结构

**解决方案**：
- 将 `tauri.conf.json` 移动到 `src-tauri/` 目录
- 调整项目结构符合 Tauri 2.0 规范

### 4. Cargo.toml 配置问题

**问题描述**：
```bash
can't find library `chatgpt_tool_lib`, rename file to `src/lib.rs` or specify lib.path
```

**原因分析**：
- Tauri 2.0 不需要 `[lib]` 配置
- 项目类型应该是二进制应用，不是库

**解决方案**：
- 移除 `[lib]` 部分
- 更新依赖版本到 2.0

### 5. 前端服务启动问题

**问题描述**：
```bash
bun run dev
$ vite
bun: command not found: vite
```

**原因分析**：
- bun 在 Windows 环境下无法正确解析 `node_modules/.bin/` 路径
- 依赖包虽然安装但无法通过 `bun run` 调用

**解决方案**：
- 使用 `npx vite` 直接调用
- 修改 package.json 脚本使用 npx
- 或切换到 pnpm 包管理器

### 6. 端口配置不匹配

**问题描述**：
```bash
Warn Waiting for your frontend dev server to start on http://localhost:8080/...
```

**原因分析**：
- Vite 默认配置端口 1420
- Tauri 期望端口 8080
- 端口不匹配导致无法连接

**解决方案**：
- 修改 `vite.config.ts` 中的端口配置
- 统一使用端口 8080

### 7. Rust 编译环境问题

**问题描述**：
```bash
error: linker `link.exe` not found
note: please ensure that Visual Studio 2017 or later, or Build Tools for Visual Studio were installed with the Visual C++ option.
```

**原因分析**：
- Windows 上编译 Rust 需要 MSVC 工具链
- 需要安装 Visual Studio Build Tools 或完整版
- 环境配置复杂，容易出错

**解决方案**：
- 安装 Visual Studio Build Tools
- 选择 C++ build tools 工作负载
- 配置正确的环境变量

## 技术栈对比分析

### Tauri 优势
- 性能更好（Rust 后端）
- 包体积更小（不包含 Chromium）
- 更安全（系统 API 权限控制）
- 跨平台支持

### Tauri 劣势
- Windows 开发环境配置复杂
- 需要 Rust 编译环境
- 学习曲线陡峭
- 社区资源相对较少
- 版本 2.0 还在发展中

### Electron 优势
- Windows 开发体验最好
- 配置简单直观
- 社区支持成熟
- 调试工具丰富
- 不需要额外编译环境

## 最终结论

**放弃 Tauri 的原因**：

1. **开发环境复杂性**：在 Windows 上配置 Rust 编译环境过于复杂
2. **配置格式不稳定**：Tauri 2.0 配置格式变化频繁，文档不够清晰
3. **调试困难**：错误信息不够明确，问题定位困难
4. **时间成本**：解决环境问题花费时间过多，影响开发效率

**推荐方案**：

对于 Windows 开发环境，建议使用 **Electron**：
- 开发体验更好
- 配置更简单
- 社区资源丰富
- 调试更容易

## 经验教训

1. **技术选型要考虑开发环境**：不能只看最终效果，还要考虑开发过程的复杂性
2. **版本稳定性很重要**：选择相对稳定的版本，避免使用还在发展中的新版本
3. **社区支持很关键**：遇到问题时，成熟的社区能提供更好的解决方案
4. **环境配置要提前验证**：在项目开始前，先验证开发环境是否能够正常工作

## 后续计划

1. **切换到 Electron**：重新设计项目架构，使用 Electron + React + TypeScript
2. **保持功能一致**：确保新版本与原 Python 工具功能完全一致
3. **优化用户体验**：利用 Electron 的优势，提供更好的桌面应用体验
4. **考虑 Tauri 1.x**：如果后续需要，可以考虑使用更稳定的 Tauri 1.x 版本
